{% extends "govuk-prototype-kit/layouts/govuk-branded.html" %}

{% block pageTitle %}
Facility – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block header %}
  {% include "includes/head.html" %}
{% endblock %}

{% block pageScripts %}
  {% include "includes/scripts.html" %}
{% endblock %}

{% block beforeContent %}
  {% include "includes/phase-banner.html" %}


  {{ govukBackLink({
    text: "Back",
    href: "facility-list"
  }) }}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <span class="govuk-caption-l">Bank reference {{ data['facility-5-ref'] }}</span>
    <h1 class="govuk-heading-xl">
      {{ data['facility-5-name'] }}
    </h1>
    <h2 class="govuk-heading-l">Overview</h2>
    <dl class="govuk-summary-list govuk-!-margin-bottom-9">
      
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-!-width-one-half">
          Exporter
        </dt>
        <dd class="govuk-summary-list__value govuk-!-width-one-half">
          {{ data['facility-5-name'] }}
        </dd>
      </div>
      
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Bank reference
        </dt>
        <dd class="govuk-summary-list__value">
          {{ data['facility-5-ref'] }}
        </dd>
      </div>
      
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          UKEF facility ID
        </dt>
        <dd class="govuk-summary-list__value">
          {{ data['facility-5-ukef-id'] }}
        </dd>
      </div>
      
     

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Product type
        </dt>
        <dd class="govuk-summary-list__value">
          General export facility
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Facility description
        </dt>
        <dd class="govuk-summary-list__value">
          Cash
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Facility base currency
        </dt>
        <dd class="govuk-summary-list__value">
          GBP
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Cover end date
        </dt>
        <dd class="govuk-summary-list__value">
          23 July 2025
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          1 year probability of default (reported semi-annually)
        </dt>
        <dd class="govuk-summary-list__value">
          Reported in July
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Flag: 90 days still no utilisation (from date of facility letter)
        </dt>
        <dd class="govuk-summary-list__value">
          Issued
        </dd>
      </div>
      </dl>


      <h2 class="govuk-heading-l">Value and exposure</h2>
      <dl class="govuk-summary-list govuk-!-margin-bottom-9">
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key govuk-!-width-one-half">
            Facility value
          </dt>
          <dd class="govuk-summary-list__value govuk-!-width-one-half">
            GBP {{ data['facility-5-limit'] }}
          </dd>
        </div>
  
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            UKEF cover
          </dt>
          <dd class="govuk-summary-list__value">
            {{ data['facility-5-cover'] }}
          </dd>
        </div>
  
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Maximum UKEF exposure
          </dt>
          <dd class="govuk-summary-list__value">
            GBP {{ data['facility-5-limit'] }}
          </dd>
        </div>
      </dl> 

        {% if 'no' in data['facility-5-updated'] %}
        <!-- Show the previous month details-->
        <!-- Show the empty form-->

        <h2 class="govuk-heading-l">
            Utilisation and premium
          </h2>
            <dl class="govuk-summary-list govuk-!-margin-bottom-9">
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key govuk-!-width-one-half">
                  Report up to
                </dt>
                <dd class="govuk-summary-list__value govuk-!-width-one-half">
                  {{ data['end-previous-month'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Facility updated
                </dt>
                <dd class="govuk-summary-list__value">
                  {{ data['1-month-ago'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Facility utilisation
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-utilisation'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  UKEF's exposure
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-exposure'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Premium payable to UKEF
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-paid'] }} 
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Premium accrued
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-accrued'] }} 
                </dd>
              </div>
            </dl>

        <form action="/facility-list" method="post" novalidate>
          <input type="hidden" name="facility-5-updated" value="yes">

        <h2 class="govuk-heading-l">Update utilisation and premium</h2>

        <p class="govuk-body">Enter details for the {{ data['report-month'] }} report.</p>
          

        {% set utilisationHtml %} 
        Facility utilisation on {{ data['end-current-month'] }}
        {% endset %}

        {{ govukInput({
        id: "facility-5new-utilisation",
        name: "facility-5new-utilisation",
        label: {
          html: utilisationHtml,
          classes: "govuk-label--s",
          isPageHeading: false
        },
        prefix: {
          text: "GBP"
        },
        classes: "govuk-input--width-10",
        spellcheck: false
      }) }}

      {{ govukInput({
        id: "facility-5new-paid",
        name: "facility-5new-paid",
        label: {
          text: "Premium payable to UKEF",
          classes: "govuk-label--s",
          isPageHeading: false
        },
        prefix: {
          text: "GBP"
        },
        classes: "govuk-input--width-10",
        spellcheck: false
      }) }}

      {{ govukInput({
        id: "facility-5new-accrued",
        name: "facility-5new-accrued",
        label: {
          text: "Premium accrued",
          classes: "govuk-label--s",
          isPageHeading: false
        },
        prefix: {
          text: "GBP"
        },
        classes: "govuk-input--width-10",
        spellcheck: false
      }) }}

        <div class="govuk-button-group">
          {{ govukButton({
            text: "Save and continue"
          }) }}
          <a class="govuk-link govuk-link--no-visited-state" href="/facility-list">Cancel</a>
        </div>
      </form>
      
      <!-- Show once updates have been saved -->

      {% elseif 'yes' in data['facility-5-updated'] %}
      <form action="/facility5/index#update" method="post" novalidate>
        <input type="hidden" name="facility-5-updated" value="edit">


      <table class="govuk-table">
        <caption class="govuk-table__caption govuk-table__caption--l">Utilisation and premium</caption>
        <thead class="govuk-table__head">
          <tr class="govuk-table__row">
            <th scope="col" class="govuk-table__header">Report up to</th>
            <th scope="col" class="govuk-table__header">{{ data['end-current-month'] }} </th>
            <th scope="col" class="govuk-table__header">{{ data['end-previous-month'] }} </th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">Facility updated</th>
            <td class="govuk-table__cell">{{ data['todays-date'] }}</td>
            <td class="govuk-table__cell">{{ data['1-month-ago'] }}</td>
          </tr>
    
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">Facility utilisation</th>
            <td class="govuk-table__cell">GBP {{ data['facility-5new-utilisation'] }}</td>
            <td class="govuk-table__cell">GBP {{ data['facility-5-utilisation'] }}</td>
          </tr>
    
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">UKEF's exposure</th>
            <td class="govuk-table__cell">GBP {{ data['facility-5new-exposure'] }}</td>
            <td class="govuk-table__cell">GBP {{ data['facility-5-exposure'] }}</td>
          </tr>
    
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">Premium payable to UKEF</th>
            <td class="govuk-table__cell">GBP {{ data['facility-5new-paid'] }}</td>
            <td class="govuk-table__cell">GBP {{ data['facility-5-paid'] }}</td>
          </tr>
    
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">Premium accrued</th>
            <td class="govuk-table__cell">GBP {{ data['facility-5new-accrued'] }}</td>
            <td class="govuk-table__cell">GBP {{ data['facility-5-accrued'] }}</td>
          </tr>
          
        </tbody>
      </table>

        <p class="govuk-body">You can make changes to the {{ data['report-month'] }} updates before the report is submitted to UKEF.</p>
        
            {{ govukButton({
              text: "Make changes",
              classes: "govuk-button--secondary"
            }) }}
        </form>

        <!-- Show when changes want to be made to entered amounts
            text fields with already entered values -->

        {% elseif 'edit' in data['facility-5-updated'] %}
        

        <h2 class="govuk-heading-l">
            Utilisation and premium
          </h2>
            <dl class="govuk-summary-list govuk-!-margin-bottom-9">
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key govuk-!-width-one-half">
                  Report up to
                </dt>
                <dd class="govuk-summary-list__value govuk-!-width-one-half">
                  {{ data['end-previous-month'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Facility updated
                </dt>
                <dd class="govuk-summary-list__value">
                  {{ data['1-month-ago'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Facility utilisation
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-utilisation'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  UKEF's exposure
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-exposure'] }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Premium payable to UKEF
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-paid'] }} 
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Premium accrued
                </dt>
                <dd class="govuk-summary-list__value">
                  GBP {{ data['facility-5-accrued'] }} 
                </dd>
              </div>
            </dl>    


        <form action="/facility-list" method="post" novalidate>
          <input type="hidden" name="facility-5-updated" value="yes">

        <h2 class="govuk-heading-l" id="update">Update utilisation and premium</h2>
        
        <p class="govuk-body">Enter details for the {{ data['report-month'] }} report.</p>

        {% set utilisationHtml %} 
        Facility utilisation on {{ data['end-current-month'] }}
        {% endset %}

        {{ govukInput({
        id: "facility-5new-utilisation",
        name: "facility-5new-utilisation",
        label: {
          html: utilisationHtml,
          classes: "govuk-label--s"
        },
        prefix: {
          text: "GBP"
        },
        value: data['facility-5new-utilisation'],
        classes: "govuk-input--width-10",
        spellcheck: false
      }) }}

      {{ govukInput({
        id: "facility-5new-paid",
        name: "facility-5new-paid",
        label: {
          text: "Premium payable to UKEF",
          classes: "govuk-label--s",
          isPageHeading: false
        },
        prefix: {
          text: "GBP"
        },
        classes: "govuk-input--width-10",
        value: data['facility-5new-paid'],
        spellcheck: false
      }) }}

      {{ govukInput({
        id: "facility-5new-accrued",
        name: "facility-5new-accrued",
        label: {
          text: "Premium accrual",
          classes: "govuk-label--s",
          isPageHeading: false
        },
        prefix: {
          text: "GBP"
        },
        classes: "govuk-input--width-10",
        value: data['facility-5new-accrued'],
        spellcheck: false
      }) }}
  
        <div class="govuk-button-group">
          {{ govukButton({
            text: "Save and continue"
          }) }}
          <a class="govuk-link govuk-link--no-visited-state" href="/facility-list">Cancel</a>
        </div>
    
        {% endif %}

      </form>
  </div>
</div>


<!--<form action="/facility-list" method="post" novalidate>
  <input type="hidden" name="facility-5-updated" value="yes">
    {{ govukButton({
      text: "Update facility",
      value: data['facility-5-updated']
    }) }}
</form>-->


<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

  </div>
</div>

{% endblock %}
